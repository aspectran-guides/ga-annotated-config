![aspectran](http://www.aspectran.com/images/header_aspectran.png)

# gs-annotated-config
Aspectran Annotation based Configuration Example

```java
package sample;

import java.util.Map;

import com.aspectran.core.activity.Translet;
import com.aspectran.core.context.bean.annotation.Action;
import com.aspectran.core.context.bean.annotation.Configuration;
import com.aspectran.core.context.bean.annotation.Dispatch;
import com.aspectran.core.context.bean.annotation.Request;
import com.aspectran.core.context.bean.annotation.Transform;
import com.aspectran.core.context.rule.type.MethodType;
import com.aspectran.core.context.rule.type.TransformType;
import com.aspectran.core.util.logging.Log;
import com.aspectran.core.util.logging.LogFactory;

@Configuration
public class SampleAction {

    private final Log log = LogFactory.getLog(SampleAction.class);

    /**
     * http://localhost:8080/gs-annotated-config/helloWorld
     */
    @Request("helloWorld")
    @Transform(transformType = TransformType.XML)
    @Action(id = "message")
    public String helloWorld() {
        String msg = "Hello, World.";

        log.info("The message generated by my first action is: " + msg);

        return msg;
    }

    /**
     * http://localhost:8080/gs-annotated-config/front/helloWorld
     */
    @Request("front/${templateName}", method = MethodType.ALL)
    @Dispatch(name = "${templateName}")
    @Action(id = "title")
    public String restHelloWorld() {
        return "The message generated by my first action is: ";
    }

    /**
     * http://localhost:8080/gs-annotated-config/echo/this-is-a-message
     */
    @Request("echo/${echoMsg}", method = MethodType.ALL)
    @Transform(transformType = TransformType.JSON, pretty = true)
    @Action(id = "message")
    public String restEchoMessage(Translet translet) {
        String echoMsg = translet.getParameter("echoMsg");

        log.info("The message generated by my third action is: " + echoMsg);

        return echoMsg;
    }

    /**
     * http://localhost:8080/gs-annotated-config/echoParams?param1=1&param2=2
     */
    @Request("echoParams")
    @Transform(transformType = TransformType.JSON, pretty = true)
    @Action(id = "params")
    public Map<String, Object> echoParams(Translet translet) {
        Map<String, Object> params = translet.getParameterMap();

        log.info("params: " + params);

        return params;
    }

}
```

## http://localhost:8080/gs-annotated-config/helloWorld
```console
DEBUG 2017-04-23 23:47:33,273 Request URI: /gs-annotated-config/helloWorld ~com.aspectran.web.service.WebAspectranService^service:108
DEBUG 2017-04-23 23:47:33,282 translet {name=/gs-annotated-config/helloWorld, requestRule={}, responseRule={response={responseType=transform, transformType=transform/xml, contentType=text/xml, pretty=false}}, aspectAdviceRuleRegistry={settings=2}} ~com.aspectran.core.activity.CoreActivity^prepare:146
DEBUG 2017-04-23 23:47:33,292 action {actionType=method, methodActionRule={class=sample.SampleAction, method=public java.lang.String sample.SampleAction.helloWorld()}} ~com.aspectran.core.activity.CoreActivity^execute:512
DEBUG 2017-04-23 23:47:33,295 cache relevantAspectRuleHolder [/gs-annotated-config/helloWorld@class:sample.SampleAction^helloWorld] {dynamicAspectRuleList=[{id=sampleAspect, joinpointRule={joinpointType=translet, pointcutRule={pointcutPatternRule=[{translet=/gs-annotated-config/**/helloWorld, class=sample.SampleAction}]}}, aspectAdviceRuleList=[{aspectId=sampleAspect, aspectAdviceType=before, action={actionType=bean, beanActionRule={method=welcome}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=before}}}, {aspectId=sampleAspect, aspectAdviceType=after, action={actionType=bean, beanActionRule={method=goodbye}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=after}}}], beanRelevanted=true}]} ~com.aspectran.core.context.bean.proxy.AbstractDynamicBeanProxy^getRelevantAspectRuleHolder:80
DEBUG 2017-04-23 23:47:33,296 register AspectRule {id=sampleAspect, joinpointRule={joinpointType=translet, pointcutRule={pointcutPatternRule=[{translet=/gs-annotated-config/**/helloWorld, class=sample.SampleAction}]}}, aspectAdviceRuleList=[{aspectId=sampleAspect, aspectAdviceType=before, action={actionType=bean, beanActionRule={method=welcome}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=before}}}, {aspectId=sampleAspect, aspectAdviceType=after, action={actionType=bean, beanActionRule={method=goodbye}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=after}}}], beanRelevanted=true} ~com.aspectran.core.activity.AbstractActivity^registerAspectRule:435
INFO  2017-04-23 23:47:33,298 Welcome to Aspectran! (0:0:0:0:0:0:0:1) ~sample.SampleAdvice^welcome:18
INFO  2017-04-23 23:47:33,299 The message generated by my first action is: Hello, World. ~sample.SampleAction^helloWorld:30
INFO  2017-04-23 23:47:33,301 activityDataMap {message=Hello, World.} ~sample.SampleAdvice^goodbye:24
INFO  2017-04-23 23:47:33,301 Goodbye! ~sample.SampleAdvice^goodbye:28
DEBUG 2017-04-23 23:47:33,302 response {responseType=transform, transformType=transform/xml, contentType=text/xml, pretty=false} ~com.aspectran.core.activity.response.transform.XmlTransformResponse^response:81
```

## http://localhost:8080/gs-annotated-config/front/helloWorld
```console
DEBUG 2017-04-23 23:50:48,415 Request URI: /gs-annotated-config/front/helloWorld ~com.aspectran.web.service.WebAspectranService^service:108
DEBUG 2017-04-23 23:50:48,416 translet {name=/gs-annotated-config/front/${templateName}, method=[ALL], namePattern=/gs-annotated-config/front/*, requestRule={}, responseRule={response={responseType=dispatch, name=${templateName}}}} ~com.aspectran.core.activity.CoreActivity^prepare:146
DEBUG 2017-04-23 23:50:48,419 register AspectRule {id=transletSettings, joinpointRule={joinpointType=translet}, settingsAdviceRule={aspectId=transletSettings, aspectAdviceType=settings, settings={characterEncoding=utf-8, viewDispatcher=jspViewDispatcher}}} ~com.aspectran.core.activity.AbstractActivity^prepareAspectAdviceRule:465
DEBUG 2017-04-23 23:50:48,420 action {actionType=method, methodActionRule={class=sample.SampleAction, method=public java.lang.String sample.SampleAction.restHelloWorld()}} ~com.aspectran.core.activity.CoreActivity^execute:512
DEBUG 2017-04-23 23:50:48,421 cache relevantAspectRuleHolder [/gs-annotated-config/front/helloWorld@class:sample.SampleAction^restHelloWorld] {dynamicAspectRuleList=[{id=sampleAspect, joinpointRule={joinpointType=translet, pointcutRule={pointcutPatternRule=[{translet=/gs-annotated-config/**/helloWorld, class=sample.SampleAction}]}}, aspectAdviceRuleList=[{aspectId=sampleAspect, aspectAdviceType=before, action={actionType=bean, beanActionRule={method=welcome}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=before}}}, {aspectId=sampleAspect, aspectAdviceType=after, action={actionType=bean, beanActionRule={method=goodbye}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=after}}}], beanRelevanted=true}]} ~com.aspectran.core.context.bean.proxy.AbstractDynamicBeanProxy^getRelevantAspectRuleHolder:80
DEBUG 2017-04-23 23:50:48,421 register AspectRule {id=sampleAspect, joinpointRule={joinpointType=translet, pointcutRule={pointcutPatternRule=[{translet=/gs-annotated-config/**/helloWorld, class=sample.SampleAction}]}}, aspectAdviceRuleList=[{aspectId=sampleAspect, aspectAdviceType=before, action={actionType=bean, beanActionRule={method=welcome}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=before}}}, {aspectId=sampleAspect, aspectAdviceType=after, action={actionType=bean, beanActionRule={method=goodbye}, aspectAdviceRule={aspectId=sampleAspect, aspectAdviceType=after}}}], beanRelevanted=true} ~com.aspectran.core.activity.AbstractActivity^registerAspectRule:435
INFO  2017-04-23 23:50:48,422 Welcome to Aspectran! (0:0:0:0:0:0:0:1) ~sample.SampleAdvice^welcome:18
INFO  2017-04-23 23:50:48,422 activityDataMap {templateName=helloWorld, title=The message generated by my first action is: } ~sample.SampleAdvice^goodbye:24
INFO  2017-04-23 23:50:48,422 Goodbye! ~sample.SampleAdvice^goodbye:28
DEBUG 2017-04-23 23:50:48,423 response {responseType=dispatch, name=${templateName}} ~com.aspectran.core.activity.response.dispatch.DispatchResponse^response:58
DEBUG 2017-04-23 23:50:48,423 Cached a View Dispatcher com.aspectran.web.support.view.JspViewDispatcher@de7d590 ~com.aspectran.core.activity.response.dispatch.DispatchResponse^getViewDispatcher:137
DEBUG 2017-04-23 23:50:49,071 Dispatch to JSP [/WEB-INF/jsp/helloWorld.jsp] ~com.aspectran.web.support.view.JspViewDispatcher^dispatch:121
```

## http://localhost:8080/gs-annotated-config/echo/this-is-a-message
```console
DEBUG 2017-04-23 23:51:29,064 Request URI: /gs-annotated-config/echo/this-is-a-message ~com.aspectran.web.service.WebAspectranService^service:108
DEBUG 2017-04-23 23:51:29,064 translet {name=/gs-annotated-config/echo/${echoMsg}, method=[ALL], namePattern=/gs-annotated-config/echo/*, requestRule={}, responseRule={response={responseType=transform, transformType=transform/json, contentType=application/json, pretty=true}}} ~com.aspectran.core.activity.CoreActivity^prepare:146
DEBUG 2017-04-23 23:51:29,065 register AspectRule {id=transletSettings, joinpointRule={joinpointType=translet}, settingsAdviceRule={aspectId=transletSettings, aspectAdviceType=settings, settings={characterEncoding=utf-8, viewDispatcher=jspViewDispatcher}}} ~com.aspectran.core.activity.AbstractActivity^prepareAspectAdviceRule:465
DEBUG 2017-04-23 23:51:29,065 action {actionType=method, methodActionRule={class=sample.SampleAction, method=public java.lang.String sample.SampleAction.restEchoMessage(com.aspectran.core.activity.Translet)}} ~com.aspectran.core.activity.CoreActivity^execute:512
DEBUG 2017-04-23 23:51:29,065 cache relevantAspectRuleHolder [/gs-annotated-config/echo/this-is-a-message@class:sample.SampleAction^restEchoMessage] {} ~com.aspectran.core.context.bean.proxy.AbstractDynamicBeanProxy^getRelevantAspectRuleHolder:80
INFO  2017-04-23 23:51:29,065 The message generated by my third action is: this-is-a-message ~sample.SampleAction^restEchoMessage:54
DEBUG 2017-04-23 23:51:29,066 response {responseType=transform, transformType=transform/json, contentType=application/json, pretty=true} ~com.aspectran.core.activity.response.transform.JsonTransformResponse^response:73
```

## http://localhost:8080/gs-annotated-config/echoParams?param1=1&param2=2
```console
DEBUG 2017-04-23 23:53:03,866 Request URI: /gs-annotated-config/echoParams ~com.aspectran.web.service.WebAspectranService^service:108
DEBUG 2017-04-23 23:53:03,866 translet {name=/gs-annotated-config/echoParams, requestRule={}, responseRule={response={responseType=transform, transformType=transform/json, contentType=application/json, pretty=true}}, aspectAdviceRuleRegistry={settings=2}} ~com.aspectran.core.activity.CoreActivity^prepare:146
DEBUG 2017-04-23 23:53:03,866 action {actionType=method, methodActionRule={class=sample.SampleAction, method=public java.util.Map sample.SampleAction.echoParams(com.aspectran.core.activity.Translet)}} ~com.aspectran.core.activity.CoreActivity^execute:512
DEBUG 2017-04-23 23:53:03,867 cache relevantAspectRuleHolder [/gs-annotated-config/echoParams@class:sample.SampleAction^echoParams] {} ~com.aspectran.core.context.bean.proxy.AbstractDynamicBeanProxy^getRelevantAspectRuleHolder:80
INFO  2017-04-23 23:53:03,867 params: {param1=1, param2=2} ~sample.SampleAction^echoParams:68
DEBUG 2017-04-23 23:53:03,867 response {responseType=transform, transformType=transform/json, contentType=application/json, pretty=true} ~com.aspectran.core.activity.response.transform.JsonTransformResponse^response:73
```